<div class="card" style="max-width: 500px; margin: 2rem auto;">
  <h2 class="card-title">ログイン</h2>

  <% if (typeof error !== 'undefined' && error) { %>
    <div class="alert alert-error"><%= error %></div>
  <% } %>

  <form action="/api/auth/login" method="POST" id="loginForm">
    <div class="form-group">
      <label for="email">メールアドレス</label>
      <input type="email" id="email" name="email" required>
    </div>

    <div class="form-group">
      <label for="password">パスワード</label>
      <input type="password" id="password" name="password" required>
    </div>

    <button type="submit" class="btn btn-primary btn-block">ログイン</button>
  </form>

  <p style="margin-top: 1rem; text-align: center;">
    <a href="/forgot-password" style="color: #2563eb;">パスワードをお忘れですか？</a>
  </p>

  <p style="margin-top: 1.5rem; text-align: center;">
    アカウントをお持ちでない方は <a href="/register" style="color: #2563eb;">新規登録</a>
  </p>
</div>

<script>
document.getElementById('loginForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  const formData = new FormData(e.target);
  const data = Object.fromEntries(formData);

  try {
    const response = await fetch('/api/auth/login', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    });

    const result = await response.json();

    if (response.ok) {
      window.location.href = '/my-page';
    } else {
      alert(result.error || 'ログインに失敗しました');
    }
  } catch (error) {
    alert('エラーが発生しました');
  }
});
</script>
